
Jobsub_tools 

A KITS product containing all the Intensity Frontier grid submission tools.

Usage:
setup jobsub_tools 
(then)
jobsub [options]
minos_jobsub [options]
minerva_jobsub [options]
nova_jobsub [options]
dagNabbit.py [options]

no need for sourcing /grid/fermiapp/......setup_(some)_condor.sh

$JOBSUB_TOOLS_DIR/docs contains additional documentation
$JOBSUB_TOOLS_DIR/test contains unit tests and usage examples


--------------------------
RELEASE NOTES
--------------------------
v0_1  5/17/2012
===========================
First UPS/UPD version, KITS product is jobsub_tools, i.e.  setup jobsub_tools

Includes unit test, to run:
sh $JOBSUB_TOOLS_DIR/test/Run_Unit_Tests.sh

includes functionality test, to submit jobs (and expected output):
$JOBSUB_TOOLS_DIR/test/Run_All_Tests.sh 
testing a grid job
/nova/data/condor-tmp/dbox/test_grid_env.sh_20120806_142211_26319_1.cmd
submitting....
Submitting job(s).
Logging submit event(s).
1 job(s) submitted to cluster 3796504.
testing a local job
/nova/data/condor-tmp/dbox/test_local_env.sh_20120806_142211_26328_1.cmd
submitting....
Submitting job(s).
Logging submit event(s).
1 job(s) submitted to cluster 3796505.

---------------------------------------------------------
condor_q dbox will show the progress of your jobs just 
submitted to gpsn01.fnal.gov
ifront_q will show the state of everyones jobs on this node
---------------------------------------------------------


v0_2  
======================
Unit tests improved.

v0_3  6/7/12
======================
-fixes to dagNabbit.py
-fixed: return value of condor job becomes return value of jobsub
-request_robot_cert accomodates new behavior of kxlist -p

v0_4  7/19/12
======================
- works correctly with csh or sh
- changed underlying option handling to use optparse package

v0_5 8/6/12
=====================
- Submission to SMU for Nova works

v0_7  8/31/12
====================
- bugfix, jobsub [jobsub_options] script [script_options] was incorrectly
  grabbing any [script_option] that began with a dash and making it 
  a [jobsub_option]
- documentation fixes
- changed default Joblease_duration to 1 hr from 20 minutes

v1_0  9/14/12
===================
- first production release
- documentation subdirectory, improved jobsub -h behavior
- changed default mail behavior, default is to send mail on error

v1_1 9/27/12
==================
- increased jobleaseduration to 6 hours
- fixed a bug where -opportunistic was interpreted as 
   --outputfile=='pportunistic'

v1_1a 9/28/12
===================
- fixed a bug where -e was quoting vars when it should not ie
export FOO=BAR
jobsub -e FOO should result in $FOO == BAR being true on worker node, 
 but it was actually  $FOO="BAR" being true.  fixed.

v1_1b 10/17/12
=====================================================
-fixed a nova configuration bug for nova
-changed -L option to record stderr as well as stdin output

v1_1c 10/18/12
===================================================
- fixed a typo in csh environment for nova
- made jobsub aware of mars gftp servers


v1_1d 11/8/12
===============================================
-fixed a problem with -T option, test queue works now
-fixed URI for samweb which changed recently

v1_1e 11/9/12
==========================================
- fixed a bug where dag files were not submitted properly

v1_1f 11/19/12
=============================================
- more dag file fixing
- changed order of PATH for wrapped, metered condor commands (condor_q etc)

v1_1g 12/11/12
==================================================
-removed minerva_q, it behaved differently than what they expected

v1_1h 12/19/12
==================================================
-changed path to ifdhc ups product

v1_1i 1/19/13
==================================================
- changed default behavior of -L /path/to/logfile behavior
  now write logfile to local disk on worker node, then
  gridftp or cpn it back to specified location.
  This behavior can be overridden with --no_log_buffer flag

v1_1j 1/22/13
=========================================================
-fixed a bug for minerva, now picks up the $CMTCONFIG env variable
-changed the wrapped condor commands to use ssh -akx instead of ssh -ak

v1_1k 1/25/13
=========================================================
-fixed a bug for minerva, now picks up the $CMTCONFIG env variable
 v1_1j release did not pick up this change due to svn misuse

v1_1n 2/13/13
==========================================================
-gridftp fix, command to transfer output data back got removed
in 1_1k by svn misuse

v1_1o  2/18/13
==========================================================
another gridftp fix, bug in cpn style locking mechanism allowed
gridftp servers to become overloaded

v1_1p 2/20/13
==========================================================
-added ifdh log monitoring for job start, job end, file transfers 
 in and out with -f and -d flags
-minor bug fixes exposed by improved test suite

v1_1q 2/28/13
==========================================================
-replaced cpn and gridftp file transfers with ifdh cp commands
which default correctly to underlying cpn or gridftp.  All transfer
in with -f option defaults to cpn for speed.

-improved documentation output with -h flag

-updated TMP,TMPDIR,TEMP to have same value of $_CONDOR_SCRATCH_DIR 
at beginning of job execution on FNAL Grid. 


v1_1r 3/8/13
=============================================================
-changed ifdh file transfers to use current ifdh instead of
hard coded v1_0_2 ifdh used in jobsub v1_1q .  This behavior
can be overridden by using environment variable IFDH_VERSION
with the -e flag, ie to use ifdh v1_0_3:
export IFDH_VERSION=v1_0_3
jobsub -e IFDH_VERSION (the rest of the command)

- fixed problems with unit tests and integration tests giving
false positives

- added sanity check for -e flag, it will complain now if you
do jobsub -d FOO without setting $FOO first

-updated OSG_WN_TMP to have same value as TMP,TMPDIR,TEMP,and  
$_CONDOR_SCRATCH_DIR at beginning of job execution on FNAL Grid. 
 
v1_1s 3/13/13
=============================================================
- changed behavior of -f flag when used to copy in multiple files
previously, each file specified with -f was wrapped with its
own CPN locks. Starting with this version, a CPN lock will be
taken out, all the files copied in, and then the CPN lock will
be released.

v1_1t 3/14/13
==============================================================

-changes behavior of -d flag so that multiple copies out are wrapped
with one CPN lock, similar to -f behavior as of v1_1s

-fixed unit tests broken by v1_1s code changes

v1_1u 3/19/13
=============================================================
-fix of chmod bug for copying output on v1_1t
