<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>UsingJobSub - IFront - Fermilab Redmine</title>
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta http-equiv="X-UA-Compatible" content="IE=9; IE=8; IE=7; IE=EDGE" />
<meta name="csrf-param" content="authenticity_token"/>
<meta name="csrf-token" content="RWjOjG7dPgpOU3lQbCiIvZnWQ3av8HlqlWIEA5KKDwM="/>
<link rel='shortcut icon' href='/redmine/favicon.ico?1344624661' />
<link href="/redmine/stylesheets/application.css?1334916116" media="all" rel="stylesheet" type="text/css" />

<script src="/redmine/javascripts/prototype.js?1334916116" type="text/javascript"></script>
<script src="/redmine/javascripts/effects.js?1334916116" type="text/javascript"></script>
<script src="/redmine/javascripts/dragdrop.js?1334916116" type="text/javascript"></script>
<script src="/redmine/javascripts/controls.js?1334916116" type="text/javascript"></script>
<script src="/redmine/javascripts/application.js?1334916116" type="text/javascript"></script>
<script type="text/javascript">
//<![CDATA[
Event.observe(window, 'load', function(){ new WarnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>

<!--[if IE 6]>
    <style type="text/css">
      * html body{ width: expression( document.documentElement.clientWidth < 900 ? '900px' : '100%' ); }
      body {behavior: url(/redmine/stylesheets/csshover.htc?1334916116);}
    </style>
<![endif]-->
 <link href="/redmine/plugin_assets/redmine_group_assignee/stylesheets/tab_content_assignees.css" media="screen" rel="stylesheet" type="text/css" /> 
<!-- page specific tags -->

  <link href="/redmine/stylesheets/scm.css?1334916116" media="screen" rel="stylesheet" type="text/css" />
</head>
<body class="controller-wiki action-show">
<div id="wrapper">
<div id="wrapper2">
<div id="top-menu">
    <div id="account">
        <ul><li><a href="/redmine/login" class="login">Sign in</a></li></ul>    </div>
    
    <ul><li><a href="/redmine/" class="home">Home</a></li>
<li><a href="/redmine/projects" class="projects">Projects</a></li>
<li><a href="http://www.redmine.org/guide" class="help">Help</a></li></ul></div>

<div id="header">
    
    <div id="quick-search">
        <form action="/redmine/projects/ifront/search" method="get">
        <input name="wiki_pages" type="hidden" value="1" />
        <label for='q'>
          <a href="/redmine/projects/ifront/search" accesskey="4">Search</a>:
        </label>
        <input accesskey="f" class="small" id="q" name="q" size="20" type="text" />
        </form>
        
    </div>
    

    <h1>IFront</h1>

    
    <div id="main-menu">
        <ul><li><a href="/redmine/projects/ifront" class="overview">Overview</a></li>
<li><a href="/redmine/projects/ifront/activity" class="activity">Activity</a></li>
<li><a href="/redmine/projects/ifront/issues" class="issues">Issues</a></li>
<li><a href="/redmine/projects/ifront/issues/gantt" class="gantt">Gantt</a></li>
<li><a href="/redmine/projects/ifront/issues/calendar" class="calendar">Calendar</a></li>
<li><a href="/redmine/projects/ifront/news" class="news">News</a></li>
<li><a href="/redmine/projects/ifront/documents" class="documents">Documents</a></li>
<li><a href="/redmine/projects/ifront/wiki" class="wiki selected">Wiki</a></li>
<li><a href="/redmine/projects/ifront/files" class="files">Files</a></li>
<li><a href="/redmine/projects/ifront/repository" class="repository">Repository</a></li></ul>
    </div>
    
</div>

<div class="" id="main">
    <div id="sidebar">
        
  
<h3>Wiki</h3>

<a href="/redmine/projects/ifront/wiki">Start page</a><br />
<a href="/redmine/projects/ifront/wiki/index">Index by title</a><br />
<a href="/redmine/projects/ifront/wiki/date_index">Index by date</a><br />


        
    </div>

    <div id="content">
        
        <div class="contextual">


<span class="wiki_page-8303-watcher"></span>






<a href="/redmine/projects/ifront/wiki/UsingJobSub/history" class="icon icon-history">History</a>
</div>





<div class="wiki wiki-page">
  <a name="Using-the-job-submission-tools"></a>
<h1 >Using the job submission tools.<a href="#Using-the-job-submission-tools" class="wiki-anchor">&para;</a></h1>


	<a name="Background"></a>
<h2 >Background<a href="#Background" class="wiki-anchor">&para;</a></h2>


	<p>Intensity Frontier experiments model their submission systems on the architecture pioneered by the MINOS experiment.  A condor control file is generated by a script that accepts input and output directives as arguments.</p>


	<p>As new IF experiments began using the grid, they copied MINOS's scripts and  modified them to their own needs.  This resulted in a plethora of scripts, minos_jobsub, nova_jobsub, minerva_jobsub etc.   These scripts have been unified into a single 'jobsub' script ( <a href="http://cd-docdb.fnal.gov/cgi-bin/RetrieveFile?docid=4082;filename=if-job-sub-requirements-v1.pdf" class="external">DocDB 4082</a> )and re-written in an object oriented manner using plugins to manage experiment-specific needs.</p>


	<p>Chaining of dependencies of jobs is handled through a separate application, a DAG generator where users chain together jobsub commands in an xml style control file which generates condor DAG control files.</p>


	<p>The jobsub command has been packaged with other tools for submitting and monitoring grid jobs into UPS/UPD. The package can be invoked as the jobsub_tools package in KITS.</p>


	<a name="Prerequisites"></a>
<h2 >Prerequisites<a href="#Prerequisites" class="wiki-anchor">&para;</a></h2>


You must have the following before using GPCF:
	<ul>
	<li>A Services account </li>
		<li>A Fermilab Kerberos principle</li>
		<li>An account on FNALU with a AFS home area</li>
	</ul>


	<p>These three accounts can be obtained by following the directions <a href="https://cdcvs.fnal.gov/redmine/projects/ifront/wiki/Getting_Started" class="external">here</a>.</p>


	<a name="Request-your-interactive-account"></a>
<h3 >Request your interactive account<a href="#Request-your-interactive-account" class="wiki-anchor">&para;</a></h3>


	<p>You must have an experiment interactive account on the the GPCF cluster. <br /><strong>DO NOT DO THIS UNTIL YOU HAVE AN FNALU ACCOUNT</strong></p>


Send mail including your FNALU user name
	<ul>
	<li>NOVA and MINERVA: To <a class="email" href="mailto:nova-computing@fnal.gov">nova-computing@fnal.gov</a> or <a class="email" href="mailto:minerva-computing@fnal.gov">minerva-computing@fnal.gov</a>. </li>
		<li>For LBNE, MU2E, and all other experiments send mail to <a class="email" href="mailto:ifront-computing@fnal.gov">ifront-computing@fnal.gov</a>.</li>
	</ul>


	<a name="Request-a-robot-cert-for-gpsn01-and-set-up-your-proxy"></a>
<h3 >Request a robot cert for gpsn01 and set up your proxy<a href="#Request-a-robot-cert-for-gpsn01-and-set-up-your-proxy" class="wiki-anchor">&para;</a></h3>


	<ul>
	<li>Follow the <a href="https://cdcvs.fnal.gov/redmine/projects/ifront/wiki/Getting_Started_on_GPCF#GENERAL-INSTRUCTIONS" class="external">General instructions</a> at <a href="/redmine/projects/ifront/wiki/Getting_Started_on_GPCF" class="wiki-page">Getting Started on GPCF</a></li>
		<li>Then set up your proxy. Examaples are under <a href="https://cdcvs.fnal.gov/redmine/projects/ifront/wiki/Getting_Started_on_GPCF#Getting-Grid-permissions-every-other-time" class="external">Getting Grid permissions every other time</a></li>
	</ul>


	<a name="Jobsub-setup"></a>
<h2 >Jobsub setup<a href="#Jobsub-setup" class="wiki-anchor">&para;</a></h2>


	<ol>
	<li>log on to any (experimentgpvmnn) machine</li>
		<li>source /grid/fermiapp/products/experimentname/etc/setups.sh</li>
		<li>setup jobsub_tools</li>
	</ol>


	<p>for example, a minerva user:<br /><pre>
[myuserid@anymachine ~]$ ssh anyuser@minervagpvm01
[myuserid@minervagpvm02 ~]$ 
[myuserid@minervagpvm02 ~]$ source /grid/fermiapp/products/minerva/etc/setups.sh
[myuserid@minervagpvm02 ~]$ setup jobsub_tools
</pre></p>


	<p>This will make all the jobsub tools and Condor monitoring tools available in your command path. The environment variable <strong>$JOBSUB_TOOLS_DIR</strong> contains the location of jobsub, minerva_jobsub, minos_jobsub, dagNabbit.py, minos_q, ifront_q, and all the condor_wrapper commands (i.e. condor_rm throttled so as not to kill the SAZ). See <strong><a href="/redmine/projects/ifront/wiki/JOBSUB_TOOLS_DIR" class="wiki-page">JOBSUB_TOOLS_DIR</a></strong> for a complete listing.</p>


	<a name="Using-jobsub"></a>
<h2 >Using jobsub<a href="#Using-jobsub" class="wiki-anchor">&para;</a></h2>


	<p><strong>For a quick startup example go <a href="https://cdcvs.fnal.gov/redmine/projects/ifront/wiki/Getting_Started_on_GPCF#Interactive-Example-Running-Hello-World-as-an-LBNE-User" class="external">here</a>.</strong></p>


	<p>The jobsub command takes many optional arguments. A complete <strong><a href="/redmine/projects/ifront/wiki/Jobsub_options" class="wiki-page">jobsub options</a></strong> list can be found by running jobsub with the "-h" option.<br />Usage: <strong>jobsub [args] executable [exec_args]</strong><br />Where <em>args</em> are jobsub options, <em>executable</em> is the full path of your job executable and <em>exec_args</em> are options to your job.<br />The executable must be in an area of Bluearc space to which both the local submission node(gpsn01.fnal.gov) and worker nodes have access. See this <a href="https://cdcvs.fnal.gov/redmine/projects/ifront/wiki/Getting_Started_on_GPCF#Using-the-Grid-resources-at-Fermilab" class="external">NOTE</a> for details.</p>


	<p>To verify the environment is correctly set up, execute <strong>$JOBSUB_TOOLS_DIR/tests/Run_All_Tests.sh</strong></p>


	<a name="Using-jobsub-to-execute-DAGs"></a>
<h2 >Using jobsub to execute DAGs<a href="#Using-jobsub-to-execute-DAGs" class="wiki-anchor">&para;</a></h2>


	<p>Condor supports the use of DAGs(Directed Acyclic Graphs) for submission of dependent jobs and flow control. dagNabbit.py takes a formatted input file, then generates Condor command files and a Condor DAG control file. dagNabbit.py uses jobsub "-n" option which generates a Condor job submission file, but does not execute the job. This file is submitted to Condor by the DAG control file.</p>


	<p><strong><a href="/redmine/projects/ifront/wiki/DagNabbitpy_instructions" class="wiki-page">dagNabbit.py instructions</a></strong></p>


	<a name="Condor-commands-included-in-jobsub-tools"></a>
<h2 >Condor commands included in jobsub tools<a href="#Condor-commands-included-in-jobsub-tools" class="wiki-anchor">&para;</a></h2>


<pre>
build_links            condor_dump_history  condor_q               condor_run                  condor_userprio
condor                 condor_findhost      condor_qedit           condor_stats                condor_vacate
condor_checkpoint      condor_glidein       condor_release         condor_status               condor_vacate_job
condor_check_userlogs  condor_history       condor_reschedule      condor_submit               condor_version
condor_cod             condor_hold          condor_rm              condor_submit_dag           condor_wait
condor_compile         condor_load_history  condor_router_history  condor_transfer_data        CVS
condor_config_val      condor_power         condor_router_q        condor_userlog              genCondorWrappers.pl
condor_dagman          condor_prio          condor_router_rm       condor_userlog_job_counter  generic_wrapper
</pre>
</div>














        
        <div style="clear:both;"></div>
    </div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>

<div id="footer">
  <div class="bgl"><div class="bgr">
    Powered by <a href="http://www.redmine.org/">Redmine</a> &copy; 2006-2012 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>





</body>
</html>
